<!DOCTYPE html>
<html>
    <head>
        <script src="https://unpkg.com/html5-qrcode"></script>
        <script>
            var decodedAddress = "";
            function returnScan() {
                try {
                var curHash = window.location.hash,
                    fromURL = new URL(decodeURIComponent(curHash.substr(1)))
                    fromJSON = JSON.parse(atob(fromURL.hash.substr(1)))
                //fromJSON.address = "TESTADDRESS"
                fromJSON.address = decodedAddress
                alert("Using hash json: " + JSON.stringify(fromJSON))
                fromURL.hash = btoa(JSON.stringify(fromJSON))
                window.location = fromURL.href;
                } catch (e) {
                    alert("Error: " + e.toString())
                }
            }
        </script>
    </head>
    <body>
        <div id="qr-reader" style="width: 600px"></div>
        <button onclick="returnScan();">Use code</button>
        <script>
            function onScanSuccess(decodedText, decodedResult) {
                //console.log(`Code scanned = ${decodedText}`, decodedResult)
                decodedAddress = decodedText.indexOf(':') >= 0 ? 
                    decodedText.split(":")[1] : decodedText
                alert("Code has been found: " + decodedAddress)
            }
            var html5QrcodeScanner = new Html5QrcodeScanner(
                "qr-reader", { fps: 10, qrbox: 250 }
            )
            html5QrcodeScanner.render(onScanSuccess)
        </script>
    </body>
</html>